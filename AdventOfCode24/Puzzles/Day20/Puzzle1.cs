namespace AdventOfCode.Puzzles.Day20;

using BenchmarkDotNet.Attributes;
using BenchmarkDotNet.Jobs;
using NUnit.Framework;

[MemoryDiagnoser(false)]
[SimpleJob(RuntimeMoniker.Net90, baseline: true, iterationCount: 20)]
public class Puzzle1
{
    private static readonly (int dx, int dy)[] Directions = [(1, 0), (-1, 0), (0, 1), (0, -1)];

    [Test]
    [Benchmark]
    public void Solve()
    {
        var grid = PuzzleInput
            .Split('\n', StringSplitOptions.RemoveEmptyEntries)
            .Select(x => x.ToCharArray())
            .ToArray();
        var cells = grid.SelectMany((row, i) => row.Select((cell, j) => (x: i, y: j, cell)))
            .ToArray();
        var rows = grid.Length;
        var cols = grid[0].Length;

        var start = cells.First(x => x.cell is 'S');
        var end = cells.First(x => x.cell is 'E');

        var distanceFromStart = Traverse(grid, start);
        var distanceToEnd = Traverse(grid, end);

        var cost = distanceFromStart[end.x][end.y];
        var cheats = new HashSet<(int xStart, int yStart, int xEnd, int yEnd, int saved)>();

        var queue = new Queue<((int x, int y), int)>();
        var visited = new int[rows, cols];

        for (var x = 0; x < rows; x++)
        {
            for (var y = 0; y < cols; y++)
            {
                if (grid[x][y] is '#' || distanceFromStart[x][y] is int.MaxValue)
                {
                    continue;
                }

                Array.Clear(visited);
                queue.Enqueue(((x, y), 0));

                while (queue.Count > 0)
                {
                    var ((nx, ny), length) = queue.Dequeue();

                    if (grid[nx][ny] is not '#' && distanceToEnd[nx][ny] is not int.MaxValue)
                    {
                        var delta = cost - (distanceFromStart[x][y] + length + distanceToEnd[nx][ny]);

                        cheats.Add((x, y, nx, ny, delta));
                    }

                    if (length < 2)
                    {
                        var nlength = length + 1;

                        foreach (var (dx, dy) in Directions)
                        {
                            var nnx = nx + dx;
                            var nny = ny + dy;

                            if (nnx >= 0 && nnx < rows && nny >= 0 && nny < cols)
                            {
                                if (visited[nnx, nny] is 0 || visited[nnx, nny] > nlength)
                                {
                                    visited[nnx, nny] = nlength;

                                    queue.Enqueue(((nnx, nny), nlength));
                                }
                            }
                        }
                    }
                }
            }
        }

        Console.WriteLine(cheats.Count(x => x.saved >= 100));
    }

    private static int[][] Traverse(char[][] grid, (int x, int y, char cell) start)
    {
        var queue = new Queue<(int, int)>([(start.x, start.y)]);
        var distances = Enumerable
            .Repeat(int.MaxValue, grid.Length * grid[0].Length)
            .Chunk(grid.Length)
            .ToArray();

        distances[start.x][start.y] = 0;

        while (queue.Count > 0)
        {
            var (x, y) = queue.Dequeue();

            foreach (var (dx, dy) in Directions)
            {
                var nx = x + dx;
                var ny = y + dy;

                if (
                    nx >= 0
                    && nx < grid.Length
                    && ny >= 0
                    && ny < grid[0].Length
                    && grid[nx][ny] is not '#'
                    && distances[nx][ny] > distances[x][y] + 1
                )
                {
                    distances[nx][ny] = distances[x][y] + 1;

                    queue.Enqueue((nx, ny));
                }
            }
        }

        return distances;
    }

    private const string PuzzleInput = """
        #############################################################################################################################################
        #...#...#.........#...#...#...#...#.......#.........#.....###.........#...#...#...#...#...###.......#.........#.....#...#.....#...#...#...###
        #.#.#.#.#.#######.#.#.#.#.#.#.#.#.#.#####.#.#######.#.###.###.#######.#.#.#.#.#.#.#.#.#.#.###.#####.#.#######.#.###.#.#.#.###.#.#.#.#.#.#.###
        #.#.#.#.#.......#.#.#...#.#.#.#.#.#.#.....#.......#.#.#...#...#...#...#.#...#...#...#...#...#.#.....#.#...#...#.#...#.#.#...#...#.#.#.#.#...#
        #.#.#.#.#######.#.#.#####.#.#.#.#.#.#.###########.#.#.#.###.###.#.#.###.###################.#.#.#####.#.#.#.###.#.###.#.###.#####.#.#.#.###.#
        #.#.#.#...###...#.#.....#.#.#...#...#.#...###...#.#...#...#...#.#.#...#.....#.....#...#.....#.#.#...#.#.#...###.#.###.#.....#.....#.#.#.#...#
        #.#.#.###.###.###.#####.#.#.#########.#.#.###.#.#.#######.###.#.#.###.#####.#.###.#.#.#.#####.#.#.#.#.#.#######.#.###.#######.#####.#.#.#.###
        #.#...#...#...#...###...#...#.........#.#.#...#.#.#.......###.#.#...#.......#...#.#.#.#...#...#...#...#.....#...#...#.......#.#...#.#...#...#
        #.#####.###.###.#####.#######.#########.#.#.###.#.#.#########.#.###.###########.#.#.#.###.#.###############.#.#####.#######.#.#.#.#.#######.#
        #.#...#...#...#.###...#.....#.###...#...#.#...#.#.#.#.......#...###...#.........#...#.....#.........#.......#...#...#...###.#.#.#.#.#.......#
        #.#.#.###.###.#.###.###.###.#.###.#.#.###.###.#.#.#.#.#####.#########.#.###########################.#.#########.#.###.#.###.#.#.#.#.#.#######
        #.#.#...#.#...#...#.#...###.#.....#.#.#...#...#.#.#.#...#...#.........#.###.......#...#...#...#...#.#.#...#...#.#.#...#.#...#...#...#.......#
        #.#.###.#.#.#####.#.#.#####.#######.#.#.###.###.#.#.###.#.###.#########.###.#####.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.###.#.#################.#
        #...#...#.#.....#.#...#...#.....#...#.#.###...#.#.#.#...#...#.....#.....#...#...#.#.#.#.#...#...#...#...#.#.#.#.#...#...#.#.................#
        #####.###.#####.#.#####.#.#####.#.###.#.#####.#.#.#.#.#####.#####.#.#####.###.#.#.#.#.#.#################.#.#.#.#####.###.#.#################
        #...#...#.......#.....#.#.#...#.#.#...#...#...#...#...#.....#.....#...#...#...#...#.#.#.............#.....#.#.#...#...#...#.#...#...........#
        #.#.###.#############.#.#.#.#.#.#.#.#####.#.###########.#####.#######.#.###.#######.#.#############.#.#####.#.###.#.###.###.#.#.#.#########.#
        #.#.###.#...........#.#.#.#.#...#.#...#...#...#...#...#.#...#.......#.#.#...#.....#.#...###.....#...#.#...#.#.#...#...#.#...#.#.#.#.........#
        #.#.###.#.#########.#.#.#.#.#####.###.#.#####.#.#.#.#.#.#.#.#######.#.#.#.###.###.#.###.###.###.#.###.#.#.#.#.#.#####.#.#.###.#.#.#.#########
        #.#.....#.###.......#.#.#.#.#.....#...#.#...#...#...#.#.#.#.#.....#.#.#.#.###...#.#...#.....#...#...#...#.#.#.#...#...#.#.###.#.#.#...#.....#
        #.#######.###.#######.#.#.#.#.#####.###.#.#.#########.#.#.#.#.###.#.#.#.#.#####.#.###.#######.#####.#####.#.#.###.#.###.#.###.#.#.###.#.###.#
        #.....#...#...#.....#...#...#...#...#...#.#...#.....#.#...#.#...#...#...#...#...#.#...#.......#...#.....#.#.#...#.#.....#...#.#.#.#...#.#...#
        #####.#.###.###.###.###########.#.###.###.###.#.###.#.#####.###.###########.#.###.#.###.#######.#.#####.#.#.###.#.#########.#.#.#.#.###.#.###
        ###...#.###.....###...#.......#.#...#.#...#...#...#.#.....#...#.#.....#.....#...#.#.#...###.....#.....#.#.#.#...#.#.........#.#.#.#.#...#...#
        ###.###.#############.#.#####.#.###.#.#.###.#####.#.#####.###.#.#.###.#.#######.#.#.#.#####.#########.#.#.#.#.###.#.#########.#.#.#.#.#####.#
        #...#...#.....#...#...#...#...#.#...#.#.#...#...#.#.#...#.#...#...#...#.....#...#.#.#.....#.........#...#.#.#.....#.........#.#.#.#...#...#.#
        #.###.###.###.#.#.#.#####.#.###.#.###.#.#.###.#.#.#.#.#.#.#.#######.#######.#.###.#.#####.#########.#####.#.###############.#.#.#.#####.#.#.#
        #...#.###...#.#.#.#.......#...#.#...#...#...#.#.#.#...#...#.#...#...#...#...#...#.#...#...#...#...#.#...#.#.#...............#.#.#.#.....#...#
        ###.#.#####.#.#.#.###########.#.###.#######.#.#.#.#########.#.#.#.###.#.#.#####.#.###.#.###.#.#.#.#.#.#.#.#.#.###############.#.#.#.#########
        #...#.#.....#...#.###...#...#.#.###.#.....#.#.#.#.#.........#.#.#.#...#...#.....#...#.#.###.#.#.#.#...#.#.#.#...#.....#...#...#...#.........#
        #.###.#.#########.###.#.#.#.#.#.###.#.###.#.#.#.#.#.#########.#.#.#.#######.#######.#.#.###.#.#.#.#####.#.#.###.#.###.#.#.#.###############.#
        #.....#.........#.....#...#...#...#...#...#.#.#.#.#.....#.....#.#.#.#.....#.......#.#.#...#.#.#.#.#...#.#.#.#...#.#...#.#...#.....#.........#
        ###############.#################.#####.###.#.#.#.#####.#.#####.#.#.#.###.#######.#.#.###.#.#.#.#.#.#.#.#.#.#.###.#.###.#####.###.#.#########
        ###...###.......#...............#.....#...#.#.#.#...#...#...#...#.#.#.#...###...#.#.#.#...#.#.#.#.#.#.#.#...#.....#.....#...#.#...#.........#
        ###.#.###.#######.#############.#####.###.#.#.#.###.#.#####.#.###.#.#.#.#####.#.#.#.#.#.###.#.#.#.#.#.#.#################.#.#.#.###########.#
        #...#.....#.......#...#.......#.....#.#...#...#.#...#...#...#...#.#.#.#...#...#.#.#.#.#...#.#...#.#.#.#.#.................#...#...#...#...#.#
        #.#########.#######.#.#.#####.#####.#.#.#######.#.#####.#.#####.#.#.#.###.#.###.#.#.#.###.#.#####.#.#.#.#.#######################.#.#.#.#.#.#
        #...#...#...###.....#.#.....#.#.....#.#.....#...#.#...#.#...#...#.#...###.#...#.#.#.#.#...#.....#.#.#.#.#.........#.............#...#.#.#.#.#
        ###.#.#.#.#####.#####.#####.#.#.#####.#####.#.###.#.#.#.###.#.###.#######.###.#.#.#.#.#.#######.#.#.#.#.#########.#.###########.#####.#.#.#.#
        #...#.#...#.....#...#.......#...#...#...#...#...#...#.#...#.#.#...#.....#.#...#.#.#...#.....#...#.#.#...#.......#...#...........#...#...#.#.#
        #.###.#####.#####.#.#############.#.###.#.#####.#####.###.#.#.#.###.###.#.#.###.#.#########.#.###.#.#####.#####.#####.###########.#.#####.#.#
        #.....#...#.......#.............#.#...#...#...#.#.....#...#.#.#...#...#...#.#...#.#.........#.###.#.#...#.....#.#...#...#.........#.....#.#.#
        #######.#.#####################.#.###.#####.#.#.#.#####.###.#.###.###.#####.#.###.#.#########.###.#.#.#.#####.#.#.#.###.#.#############.#.#.#
        ###...#.#.#...#...#...........#...#...###...#...#.....#...#.#...#.###.#.....#...#.#.#...#...#...#.#.#.#.......#...#.#...#...#.....#.....#.#.#
        ###.#.#.#.#.#.#.#.#.#########.#####.#####.###########.###.#.###.#.###.#.#######.#.#.#.#.#.#.###.#.#.#.#############.#.#####.#.###.#.#####.#.#
        #...#...#...#.#.#.#...#.....#.#...#.....#.......#...#...#...#...#.#...#.....###...#.#.#.#.#.#...#...#.......#...###...###...#...#...#...#...#
        #.###########.#.#.###.#.###.#.#.#.#####.#######.#.#.###.#####.###.#.#######.#######.#.#.#.#.#.#############.#.#.#########.#####.#####.#.#####
        #...........#...#...#...###.#...#.#...#.......#.#.#...#...###.....#...#...#.......#.#.#...#.#.#.....#.......#.#.........#.#.....#...#.#.....#
        ###########.#######.#######.#####.#.#.#######.#.#.###.###.###########.#.#.#######.#.#.#####.#.#.###.#.#######.#########.#.#.#####.#.#.#####.#
        #...###...#.....#...#...#...#...#...#.........#.#.###...#.....#.......#.#.....#...#.#.#...#...#.#...#.........#.....#...#.#.#...#.#.#.#.....#
        #.#.###.#.#####.#.###.#.#.###.#.###############.#.#####.#####.#.#######.#####.#.###.#.#.#.#####.#.#############.###.#.###.#.#.#.#.#.#.#.#####
        #.#.#...#.......#...#.#.#.....#...............#.#.....#.#...#.#.#.....#.#.....#...#...#.#.#.....#.###...#...#...###.#...#.#...#...#...#.....#
        #.#.#.#############.#.#.#####################.#.#####.#.#.#.#.#.#.###.#.#.#######.#####.#.#.#####.###.#.#.#.#.#####.###.#.#################.#
        #.#.#.............#.#.#.#...#...###...........#.......#.#.#.#.#.#.#...#.#...#...#...#...#.#.....#.....#...#...#...#...#...#.................#
        #.#.#############.#.#.#.#.#.#.#.###.###################.#.#.#.#.#.#.###.###.#.#.###.#.###.#####.###############.#.###.#####.#################
        #.#...#...#.......#...#...#.#.#...#.......#...#.......#.#.#.#.#.#.#...#...#...#.....#...#.#...#.....#.....#.....#...#.#...#.#...............#
        #.###.#.#.#.###############.#.###.#######.#.#.#.#####.#.#.#.#.#.#.###.###.#############.#.#.#.#####.#.###.#.#######.#.#.#.#.#.#############.#
        #...#.#.#...#...#.........#.#...#.........#.#...#.....#.#.#.#.#.#...#...#.#.............#...#.......#.###...#.......#.#.#.#...#...#...#.....#
        ###.#.#.#####.#.#.#######.#.###.###########.#####.#####.#.#.#.#.###.###.#.#.#########################.#######.#######.#.#.#####.#.#.#.#.#####
        ###.#...#...#.#.#.#.......#.#...#...........#.....#.....#.#...#.#...#...#.#...#...#...#...#...#...#...#.......#...###...#...#...#.#.#.#.....#
        ###.#####.#.#.#.#.#.#######.#.###.###########.#####.#####.#####.#.###.###.###.#.#.#.#.#.#.#.#.#.#.#.###.#######.#.#########.#.###.#.#.#####.#
        #...#...#.#...#...#.......#...#...#...#.....#...###.......###...#...#...#.#...#.#.#.#...#.#.#.#.#.#.###.......#.#.....#####...###.#.#.......#
        #.###.#.#.###############.#####.###.#.#.###.###.#############.#####.###.#.#.###.#.#.#####.#.#.#.#.#.#########.#.#####.###########.#.#########
        #...#.#...###...#...#...#...#...#...#...#...#...#...#...#...#...#...###...#.....#.#.#.....#.#...#...#.......#...#...#...#.......#...#.......#
        ###.#.#######.#.#.#.#.#.###.#.###.#######.###.###.#.#.#.#.#.###.#.###############.#.#.#####.#########.#####.#####.#.###.#.#####.#####.#####.#
        ###...#...#...#...#...#.....#...#.......#...#.....#...#...#...#.#...#.....###...#.#.#...#...#.........#...#.......#.....#.#.....#...#...#...#
        #######.#.#.###################.#######.###.#################.#.###.#.###.###.#.#.#.###.#.###.#########.#.###############.#.#####.#.###.#.###
        #.......#...#.......#...#.......#.......#...#.....#.......#...#.....#.#...#...#...#.#...#...#...........#.......#...#...#.#.......#.....#...#
        #.###########.#####.#.#.#.#######.#######.###.###.#.#####.#.#########.#.###.#######.#.#####.###################.#.#.#.#.#.#################.#
        #.....#.......#...#...#...###...#.......#.....###.#.....#...#.....#...#...#...#.....#.......#...................#.#.#.#.#.#.....#...#.....#.#
        #####.#.#######.#.###########.#.#######.#########.#####.#####.###.#.#####.###.#.#############.###################.#.#.#.#.#.###.#.#.#.###.#.#
        ###...#...#.....#.......#...#.#.......#.........#.#.....#...#...#.#.....#...#.#.#.............#...............#...#...#...#...#...#.#...#.#.#
        ###.#####.#.###########.#.#.#.#######.#########.#.#.#####.#.###.#.#####.###.#.#.#.#############.#############.#.#############.#####.###.#.#.#
        #...#.....#.....#.....#...#...#.....#...........#...#...#.#.###.#.#...#.#...#...#...#.....#.....#.............#.#...#...#...#.....#.....#.#.#
        #.###.#########.#.###.#########.###.#################.#.#.#.###.#.#.#.#.#.#########.#.###.#.#####.#############.#.#.#.#.#.#.#####.#######.#.#
        #.....#...#...#.#...#...#.......###...................#...#.#...#.#.#.#.#.#...#...#.#.#...#.#...#...#...........#.#...#...#.#...#.....###...#
        #######.#.#.#.#.###.###.#.#################################.#.###.#.#.#.#.#.#.#.#.#.#.#.###.#.#.###.#.###########.#########.#.#.#####.#######
        #.......#...#.#.#...###...#.............#...#...#.....#.....#...#.#.#.#.#.#.#...#.#...#.....#.#.....#.#.....#...#.........#...#...#...#.....#
        #.###########.#.#.#########.###########.#.#.#.#.#.###.#.#######.#.#.#.#.#.#.#####.###########.#######.#.###.#.#.#########.#######.#.###.###.#
        #.........#...#...#...#.....#...#.....#.#.#.#.#.#...#.#...#...#.#.#.#...#...#.....###S#######.#...#...#...#...#...#.....#.......#.#...#.#...#
        #########.#.#######.#.#.#####.#.#.###.#.#.#.#.#.###.#.###.#.#.#.#.#.#########.#######.#######.#.#.#.#####.#######.#.###.#######.#.###.#.#.###
        #.........#.......#.#.#.....#.#...#...#...#...#...#.#.#...#.#.#.#.#.#...#...#...#.....#####...#.#.#...###.......#.#.#...#.......#...#...#...#
        #.###############.#.#.#####.#.#####.#############.#.#.#.###.#.#.#.#.#.#.#.#.###.#.#########.###.#.###.#########.#.#.#.###.#########.#######.#
        #...............#.#.#.#...#.#...#...#...#...#...#...#...#...#...#.#.#.#...#.....#.....#####.....#.....#.....#...#.#.#.....#.......#.........#
        ###############.#.#.#.#.#.#.###.#.###.#.#.#.#.#.#########.#######.#.#.###############.#################.###.#.###.#.#######.#####.###########
        #.......#.......#...#...#.#.....#.....#...#.#.#.#.......#.......#.#.#.....#...#...###...###############...#...###...###...#...#...#...#.....#
        #.#####.#.###############.#################.#.#.#.#####.#######.#.#.#####.#.#.#.#.#####.#################.#############.#.###.#.###.#.#.###.#
        #.....#.#...............#.###...###...#...#...#.#.#...#...###...#.#.#.....#.#.#.#.#...#...###############.....#.........#.....#.....#...#...#
        #####.#.###############.#.###.#.###.#.#.#.#####.#.#.#.###.###.###.#.#.#####.#.#.#.#.#.###.###################.#.#########################.###
        #.....#.###...#...###...#.....#.....#...#.......#...#...#...#...#.#.#.#...#.#.#.#...#.###.#############E....#...#...#.....#.....#...#...#...#
        #.#####.###.#.#.#.###.#################################.###.###.#.#.#.#.#.#.#.#.#####.###.#################.#####.#.#.###.#.###.#.#.#.#.###.#
        #.#...#.....#...#.....#...#.........#.....#.....###...#...#.#...#...#...#.#.#.#.....#.....###########.....#.......#...###...###.#.#...#.....#
        #.#.#.#################.#.#.#######.#.###.#.###.###.#.###.#.#.###########.#.#.#####.#################.###.#####################.#.###########
        #...#.#...........#...#.#.#.###...#...#...#.#...#...#.#...#...#.......#...#.#.....#.#...........#.....###...#.....#.....###...#...#...#.....#
        #####.#.#########.#.#.#.#.#.###.#.#####.###.#.###.###.#.#######.#####.#.###.#####.#.#.#########.#.#########.#.###.#.###.###.#.#####.#.#.###.#
        #.....#.#.........#.#.#.#.#.#...#.#...#...#.#.#...#...#.......#.#...#...#...#...#.#.#.#...#.....#...#.......#.#...#.#...#...#...#...#...#...#
        #.#####.#.#########.#.#.#.#.#.###.#.#.###.#.#.#.###.#########.#.#.#.#####.###.#.#.#.#.#.#.#.#######.#.#######.#.###.#.###.#####.#.#######.###
        #.....#.#.....#.....#...#...#...#...#.....#.#.#...#.#.....#...#...#...#...#...#...#...#.#.#.........#.........#.....#...#.#.....#.#...#...###
        #####.#.#####.#.###############.###########.#.###.#.#.###.#.#########.#.###.###########.#.#############################.#.#.#####.#.#.#.#####
        #...#...#.....#.#.......###...#.........###.#.###.#.#...#.#...#.......#...#.....#...#...#...#...#.............#...#...#...#.#.....#.#...#...#
        #.#.#####.#####.#.#####.###.#.#########.###.#.###.#.###.#.###.#.#########.#####.#.#.#.#####.#.#.#.###########.#.#.#.#.#####.#.#####.#####.#.#
        #.#.......#...#.#.#...#.....#.....#.....#...#...#.#.#...#.#...#.#.....#...#.....#.#.#.....#.#.#.#.....#.....#.#.#...#.....#...#...#.......#.#
        #.#########.#.#.#.#.#.###########.#.#####.#####.#.#.#.###.#.###.#.###.#.###.#####.#.#####.#.#.#.#####.#.###.#.#.#########.#####.#.#########.#
        #.#.......#.#.#.#.#.#...#.......#...#...#.....#.#.#.#.#...#...#.#.#...#...#.#...#.#.#...#.#.#.#.#...#...#...#.#.........#.#...#.#.#...#...#.#
        #.#.#####.#.#.#.#.#.###.#.#####.#####.#.#####.#.#.#.#.#.#####.#.#.#.#####.#.#.#.#.#.#.#.#.#.#.#.#.#.#####.###.#########.#.#.#.#.#.#.#.#.#.#.#
        #...#.....#.#.#.#.#...#...#.....#...#.#...#...#.#.#.#.#.....#.#.#.#.....#.#...#.#.#.#.#.#.#.#.#.#.#...#...###...#...#...#.#.#.#.#.#.#...#...#
        #####.#####.#.#.#.###.#####.#####.#.#.###.#.###.#.#.#.#####.#.#.#.#####.#.#####.#.#.#.#.#.#.#.#.#.###.#.#######.#.#.#.###.#.#.#.#.#.#########
        #.....#.....#.#.#...#.#.....#...#.#.#.#...#.###.#.#.#.....#.#.#.#...#...#.....#.#.#.#.#.#.#...#.#.#...#.......#.#.#.#.#...#.#.#.#.#.......###
        #.#####.#####.#.###.#.#.#####.#.#.#.#.#.###.###.#.#.#####.#.#.#.###.#.#######.#.#.#.#.#.#.#####.#.#.#########.#.#.#.#.#.###.#.#.#.#######.###
        #.#...#.#.....#...#...#.....#.#...#...#...#...#.#.#...#...#.#.#.....#...#.....#.#.#...#.#.#.....#.#.#...#.....#.#.#.#.#.#...#...#.......#...#
        #.#.#.#.#.#######.#########.#.###########.###.#.#.###.#.###.#.#########.#.#####.#.#####.#.#.#####.#.#.#.#.#####.#.#.#.#.#.#############.###.#
        #.#.#.#.#...#...#.#.........#...#.......#.#...#.#...#.#...#.#.###.......#.....#.#.....#.#.#.#...#.#...#.#.....#...#.#.#.#.###.........#...#.#
        #.#.#.#.###.#.#.#.#.###########.#.#####.#.#.###.###.#.###.#.#.###.###########.#.#####.#.#.#.#.#.#.#####.#####.#####.#.#.#.###.#######.###.#.#
        #.#.#.#.#...#.#...#...#.....#...#.#...#...#...#.#...#.#...#.#.#...#.......#...#...#...#.#.#...#.#...#...#...#...###...#.#.....#.....#...#.#.#
        #.#.#.#.#.###.#######.#.###.#.###.#.#.#######.#.#.###.#.###.#.#.###.#####.#.#####.#.###.#.#####.###.#.###.#.###.#######.#######.###.###.#.#.#
        #.#.#.#.#...#.###...#.#.#...#.###...#...#.....#...#...#...#...#...#.....#.#.#...#.#.#...#.#.....#...#...#.#.....#.....#.#.......###.....#.#.#
        #.#.#.#.###.#.###.#.#.#.#.###.#########.#.#########.#####.#######.#####.#.#.#.#.#.#.#.###.#.#####.#####.#.#######.###.#.#.###############.#.#
        #...#.#.#...#.#...#...#.#...#...###.....#.........#...#...#.......#.....#.#...#.#...#...#.#.#...#.....#.#.........#...#.#.........###...#...#
        #####.#.#.###.#.#######.###.###.###.#############.###.#.###.#######.#####.#####.#######.#.#.#.#.#####.#.###########.###.#########.###.#.#####
        #.....#.#...#.#...#...#.#...#...#...#.....#...#...###...###.....#...###...#...#.......#...#...#...#...#.#...#...#...#...#...#...#.....#.....#
        #.#####.###.#.###.#.#.#.#.###.###.###.###.#.#.#.###############.#.#####.###.#.#######.###########.#.###.#.#.#.#.#.###.###.#.#.#.###########.#
        #.......###...###.#.#.#.#.....#...#...#...#.#...###.............#.....#...#.#.#...#...#...........#.###...#.#.#.#.###.....#...#.....#.......#
        #################.#.#.#.#######.###.###.###.#######.#################.###.#.#.#.#.#.###.###########.#######.#.#.#.#################.#.#######
        ###...............#.#.#.#.......#...###...#.......#.......#.....#.....###.#.#.#.#...###.....#.....#.......#.#.#.#.......#...#...#...#.......#
        ###.###############.#.#.#.#######.#######.#######.#######.#.###.#.#######.#.#.#.###########.#.###.#######.#.#.#.#######.#.#.#.#.#.#########.#
        #...#...#...#...#...#.#.#.....#...#...###.#.......#.......#.#...#.......#...#.#...........#...###.#...#...#.#.#.#.....#...#...#.#.#...#...#.#
        #.###.#.#.#.#.#.#.###.#.#####.#.###.#.###.#.#######.#######.#.#########.#####.###########.#######.#.#.#.###.#.#.#.###.#########.#.#.#.#.#.#.#
        #.....#.#.#...#...###.#.#.....#.....#.#...#.....###.#.....#.#...#...#...#.....#...#.....#.###.....#.#...#...#.#.#...#.#...#...#.#.#.#.#.#.#.#
        #######.#.###########.#.#.###########.#.#######.###.#.###.#.###.#.#.#.###.#####.#.#.###.#.###.#####.#####.###.#.###.#.#.#.#.#.#.#.#.#.#.#.#.#
        ###.....#.#...........#.#...#...#...#.#.#.....#...#.#.###.#.#...#.#...###...#...#.#.###...#...#...#...###.....#.#...#.#.#...#...#...#...#.#.#
        ###.#####.#.###########.###.#.#.#.#.#.#.#.###.###.#.#.###.#.#.###.#########.#.###.#.#######.###.#.###.#########.#.###.#.#################.#.#
        #...#.....#...#.......#...#...#.#.#...#.#...#.#...#.#.#...#.#...#.........#.#...#.#.......#...#.#...#.........#...###.#.#...#...........#...#
        #.###.#######.#.#####.###.#####.#.#####.###.#.#.###.#.#.###.###.#########.#.###.#.#######.###.#.###.#########.#######.#.#.#.#.#########.#####
        #...#.#.......#.....#...#.#.....#.#.....#...#.#.###.#.#...#.###.#...#...#.#.#...#...#.....###.#.#...#...#...#.......#.#...#...#...#...#.....#
        ###.#.#.###########.###.#.#.#####.#.#####.###.#.###.#.###.#.###.#.#.#.#.#.#.#.#####.#.#######.#.#.###.#.#.#.#######.#.#########.#.#.#.#####.#
        ###.#.#.#.....#...#.###...#...#...#.#...#...#.#...#...###...#...#.#.#.#.#.#.#.#...#.#.......#...#...#.#...#...#.....#...#...#...#...#.#.....#
        ###.#.#.#.###.#.#.#.#########.#.###.#.#.###.#.###.###########.###.#.#.#.#.#.#.#.#.#.#######.#######.#.#######.#.#######.#.#.#.#######.#.#####
        #...#.#.#.#...#.#.#.#.........#.#...#.#...#.#...#.....#.......#...#.#.#.#.#.#.#.#...#...#...#.......#.......#.#.......#.#.#.#.....#...#.....#
        #.###.#.#.#.###.#.#.#.#########.#.###.###.#.###.#####.#.#######.###.#.#.#.#.#.#.#####.#.#.###.#############.#.#######.#.#.#.#####.#.#######.#
        #.....#...#.....#...#...........#.....###...###.......#.........###...#...#...#.......#...###...............#.........#...#.......#.........#
        #############################################################################################################################################
        """;
}
